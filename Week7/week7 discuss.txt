/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package com.mycompany.week7;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.ResultSetMetaData;


/**
 *
 * @author Travis
 */
public class JDBC {
    
    private static String dbURL = "jdbc:derby://localhost:1527/contact";
    private static String tableName = "COLLEAGUES";
    
    //Java database connection
    private static Connection conn = null;
    private static Statement stmt = null;
    
    public static void main(String[] args){
        
        createConnection();
        selectColleagues();
        shutdown();
    }
    
    private static void createConnection(){
        try{
            Class.forName("org.apache.derby.jdbc.ClientDriver").newInstance();
            //get connection
            conn = DriverManager.getConnection(dbURL);
        }
        catch (Exception e){
            e.printStackTrace();
        }
    }
    
    private static void selectColleagues(){
        try{
            stmt = conn.createStatement();
            ResultSet results = stmt.executeQuery("select * from " + tableName);
            ResultSetMetaData rsmd = results.getMetaData();
            
            int numberCols = rsmd.getColumnCount();
                for(int i =1; i <=numberCols; i++){
                    //print out column names
                    System.out.print(rsmd.getColumnLabel(i) + "t\t");
                }
                System.out.println("\n------------------------------" +
                        "-----------------------------------"
                      + "-- "  );
                
                while(results.next()){
                    int ID = results.getInt(1);
                    String firstName = results.getString(2);
                    String lastName = results.getString(3);
                    String title = results.getString(4);
                    String department = results.getString(5);
                    String email = results.getString(6);
                    
                    System.out.println(ID + "\t\t" + firstName + "\t\t" + lastName +
                    "\t\t" + title + "\t\t" + department + "\t\t" +email);
                }
                results.close();
                stmt.close();
        }
        catch(SQLException s){
            s.printStackTrace();
        }
    } 
        private static void shutdown(){
            try{
                if (stmt != null){
                    stmt.close();
                }
                if (conn != null){
                    DriverManager.getConnection(dbURL + ";shutdown = true");
                    conn.close();
                }
            }  
            catch(SQLException s){
                
            }
        }
    }
    

